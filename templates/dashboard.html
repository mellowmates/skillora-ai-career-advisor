{% extends 'base.html' %}

{% block title %}Dashboard - Skillora AI{% endblock %}

{% block content %}
<div class="container">
  <div class="dashboard-section">
    <!-- Header -->
    <div class="dashboard-header">
      <div class="header-content">
        <h1>🎯 Your Career Dashboard</h1>
        <p>Personalized recommendations based on your assessment</p>
      </div>
      
      {% if user_data %}
      <div class="user-summary">
        <div class="summary-item">
          <span class="label">Profile Completeness</span>
          <div class="progress">
            <div class="progress-bar" style="width: {{ user_data.get('profile_completeness', 0) }}%"></div>
          </div>
          <span class="value">{{ user_data.get('profile_completeness', 0) }}%</span>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Quick Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">🎯</div>
        <div class="stat-content">
          <div class="stat-number">{{ recommendations|length }}</div>
          <div class="stat-label">Career Matches</div>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">📊</div>
        <div class="stat-content">
          <div class="stat-number">{{ market_overview.get('total_jobs_available', 0)|round|int }}</div>
          <div class="stat-label">Available Jobs</div>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">📈</div>
        <div class="stat-content">
          <div class="stat-number">{{ market_overview.get('overall_growth_rate', 0) }}%</div>
          <div class="stat-label">Market Growth</div>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">🎓</div>
        <div class="stat-content">
          <div class="stat-number">{{ user_data.get('skills', [])|length or 'N/A' }}</div>
          <div class="stat-label">Your Skills</div>
        </div>
      </div>
    </div>

    <!-- Career Recommendations -->
    <div class="recommendations-section">
      <div class="section-header">
        <h2>🌟 Your Top Career Recommendations</h2>
        <p>Based on your personality, skills, and market demand analysis</p>
      </div>

      {% if recommendations %}
      <div class="recommendations-grid">
        {% for rec in recommendations %}
        <div class="recommendation-card fade-in">
          <div class="card-header">
            <div class="career-title">
              <h3>{{ rec.career_title }}</h3>
              <div class="match-score">
                <span class="score-value">{{ (rec.final_score * 100)|round(1) }}%</span>
                <span class="score-label">Match</span>
              </div>
            </div>
            <div class="career-category">{{ rec.career_category|title }}</div>
          </div>

          <div class="card-content">
            <p class="career-description">{{ rec.career_description[:150] }}...</p>
            
            <div class="career-insights">
              <div class="insight-item">
                <span class="insight-label">Growth Outlook:</span>
                <span class="insight-value growth-{{ rec.growth_outlook|lower|replace(' ', '-') }}">
                  {{ rec.growth_outlook }}
                </span>
              </div>
              
              <div class="insight-item">
                <span class="insight-label">Salary Range:</span>
                <span class="insight-value">{{ rec.salary_range.formatted }}</span>
              </div>
            </div>

            {% if rec.skill_analysis %}
            <div class="skills-match">
              <div class="skills-progress">
                <span class="skills-label">Skills Match</span>
                <div class="progress">
                  <div class="progress-bar" style="width: {{ rec.skill_analysis.skill_match_percentage }}%"></div>
                </div>
                <span class="skills-percentage">{{ rec.skill_analysis.skill_match_percentage|round(1) }}%</span>
              </div>
            </div>
            {% endif %}
          </div>

          <div class="card-actions">
            <a href="{{ url_for('career_detail', career_id=rec.career_id) }}" class="btn btn-primary">
              📋 View Details
            </a>
            <a href="{{ url_for('roadmap', career_id=rec.career_id) }}" class="btn btn-secondary">
              🗺️ Learning Path
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="empty-state">
        <div class="empty-icon">🎯</div>
        <h3>No Recommendations Yet</h3>
        <p>Complete your assessment to get personalized career recommendations</p>
        <a href="{{ url_for('assessment') }}" class="btn btn-primary">Take Assessment</a>
      </div>
      {% endif %}
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h3>🚀 Quick Actions</h3>
      <div class="actions-grid">
        <a href="{{ url_for('assessment') }}" class="action-card">
          <div class="action-icon">📝</div>
          <div class="action-content">
            <h4>Retake Assessment</h4>
            <p>Update your profile and get fresh recommendations</p>
          </div>
        </a>
        
        <a href="{{ url_for('chatbot_page') }}" class="action-card">
          <div class="action-icon">💬</div>
          <div class="action-content">
            <h4>Ask AI Advisor</h4>
            <p>Get instant career guidance from our AI chatbot</p>
          </div>
        </a>
        
        <a href="#market-insights" class="action-card">
          <div class="action-icon">📊</div>
          <div class="action-content">
            <h4>Market Insights</h4>
            <p>Explore job market trends and salary data</p>
          </div>
        </a>
        
        <a href="#skill-development" class="action-card">
          <div class="action-icon">🎓</div>
          <div class="action-content">
            <h4>Skill Development</h4>
            <p>Find courses and resources to upskill</p>
          </div>
        </a>
      </div>
    </div>

    <!-- Market Overview -->
    {% if market_overview %}
    <div id="market-insights" class="market-section">
      <h3>📈 Market Overview</h3>
      <div class="market-grid">
        <div class="market-card">
          <h4>Job Market Health</h4>
          <div class="health-score">
            <div class="score-circle">
              <span class="score">{{ (market_overview.market_health_score * 100)|round }}%</span>
            </div>
            <p>Overall market health looks good for career growth</p>
          </div>
        </div>
        
        {% if market_overview.top_sectors %}
        <div class="market-card">
          <h4>Top Growing Sectors</h4>
          <div class="sectors-list">
            {% for sector in market_overview.top_sectors[:3] %}
            <div class="sector-item">
              <span class="sector-name">{{ sector.sector|title }}</span>
              <span class="sector-growth">+{{ sector.growth_rate }}%</span>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}
      </div>
    </div>
    {% endif %}
  </div>
</div>

<style>
.dashboard-section {
  padding: 2rem 0;
}

.dashboard-header {
  background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
  color: white;
  padding: 3rem 2rem;
  border-radius: 1rem;
  margin-bottom: 2rem;
  text-align: center;
}

.header-content h1 {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
}

.user-summary {
  margin-top: 2rem;
  display: flex;
  justify-content: center;
}

.summary-item {
  display: flex;
  align-items: center;
  gap: 1rem;
  background: rgba(255, 255, 255, 0.2);
  padding: 1rem 2rem;
  border-radius: 0.5rem;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
  margin-bottom: 3rem;
}

.stat-card {
  background: var(--bg-primary);
  padding: 2rem;
  border-radius: 1rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  display: flex;
  align-items: center;
  gap: 1rem;
}

.stat-icon {
  font-size: 2rem;
}

.stat-number {
  font-size: 2rem;
  font-weight: 700;
  color: var(--primary-color);
}

.stat-label {
  color: var(--text-secondary);
  font-size: 0.875rem;
}

.recommendations-section {
  margin-bottom: 3rem;
}

.section-header {
  text-align: center;
  margin-bottom: 2rem;
}

.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
  gap: 2rem;
}

.recommendation-card {
  background: var(--bg-primary);
  border-radius: 1rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  overflow: hidden;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  border-left: 4px solid var(--primary-color);
}

.recommendation-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
}

.card-header {
  padding: 1.5rem;
  border-bottom: 1px solid var(--border-color);
}

.career-title {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.career-title h3 {
  margin: 0;
  color: var(--text-primary);
}

.match-score {
  background: var(--success-color);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 2rem;
  text-align: center;
  min-width: 80px;
}

.score-value {
  font-weight: 700;
  font-size: 1.1rem;
}

.score-label {
  font-size: 0.75rem;
  opacity: 0.9;
}

.career-category {
  color: var(--text-secondary);
  font-size: 0.875rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.card-content {
  padding: 1.5rem;
}

.career-description {
  color: var(--text-secondary);
  margin-bottom: 1rem;
  line-height: 1.6;
}

.career-insights {
  margin-bottom: 1rem;
}

.insight-item {
  display: flex;
  justify-content: space-between;
  margin-bottom: 0.5rem;
}

.insight-label {
  color: var(--text-secondary);
  font-size: 0.875rem;
}

.insight-value {
  font-weight: 500;
}

.growth-high { color: var(--success-color); }
.growth-medium { color: var(--warning-color); }
.growth-low { color: var(--error-color); }

.skills-match {
  background: var(--bg-secondary);
  padding: 1rem;
  border-radius: 0.5rem;
}

.skills-progress {
  display: flex;
  align-items: center;
  gap: 1rem;
}

.skills-label {
  font-size: 0.875rem;
  color: var(--text-secondary);
  min-width: 80px;
}

.skills-percentage {
  font-weight: 600;
  color: var(--primary-color);
  min-width: 45px;
}

.card-actions {
  padding: 1.5rem;
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 1rem;
}

.empty-state {
  text-align: center;
  padding: 4rem 2rem;
  color: var(--text-secondary);
}

.empty-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
}

.quick-actions {
  margin-bottom: 3rem;
}

.actions-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  margin-top: 1rem;
}

.action-card {
  background: var(--bg-primary);
  padding: 1.5rem;
  border-radius: 0.75rem;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  text-decoration: none;
  color: inherit;
  display: flex;
  align-items: center;
  gap: 1rem;
  transition: transform 0.3s ease;
}

.action-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
}

.action-icon {
  font-size: 2rem;
}

.action-content h4 {
  margin: 0 0 0.5rem 0;
  color: var(--text-primary);
}

.action-content p {
  margin: 0;
  color: var(--text-secondary);
  font-size: 0.875rem;
}

.market-section {
  background: var(--bg-secondary);
  padding: 2rem;
  border-radius: 1rem;
}

.market-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  margin-top: 1rem;
}

.market-card {
  background: var(--bg-primary);
  padding: 1.5rem;
  border-radius: 0.75rem;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.health-score {
  text-align: center;
}

.score-circle {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: conic-gradient(var(--success-color) 0deg, var(--success-color) 280deg, var(--border-color) 280deg);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 1rem auto;
  position: relative;
}

.score-circle::before {
  content: '';
  width: 60px;
  height: 60px;
  background: var(--bg-primary);
  border-radius: 50%;
  position: absolute;
}

.score {
  font-weight: 700;
  color: var(--primary-color);
  z-index: 1;
}

.sectors-list {
  margin-top: 1rem;
}

.sector-item {
  display: flex;
  justify-content: space-between;
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--border-color);
}

.sector-item:last-child {
  border-bottom: none;
}

.sector-growth {
  color: var(--success-color);
  font-weight: 600;
}

@media (max-width: 768px) {
  .recommendations-grid {
    grid-template-columns: 1fr;
  }
  
  .card-actions {
    flex-direction: column;
  }
  
  .actions-grid {
    grid-template-columns: 1fr;
  }
  
  .career-title {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.5rem;
  }
}
</style>
{% endblock %}
