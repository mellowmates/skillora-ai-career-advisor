{% extends 'base.html' %}

{% block title %}AI Career Chatbot - Skillora AI{% endblock %}

{% block content %}
<div class="container">
  <div class="chatbot-section">
    <!-- Chatbot Interface -->
    <div class="chatbot-main">
      <div class="chat-header">
        <h1>ðŸ’¬ AI Career Chatbot</h1>
        <p>Your personal AI assistant for career guidance, skill development, and market insights.</p>
      </div>

      <div class="chat-window" id="chat-window">
        <div id="chat-messages" class="chat-messages">
          <div class="message bot welcome-message">
            <div class="avatar">ðŸ¤–</div>
            <div class="message-content">
              Hello! Iâ€™m here to help you with career advice. Ask me anything about your career, skills, or job market!
            </div>
          </div>
        </div>
      </div>

      <form id="chat-form" autocomplete="off" class="chat-input-area">
        <textarea id="chat-input" placeholder="Type your message here..." rows="2"></textarea>
        <button type="submit" id="chat-send" disabled>Send</button>
      </form>
    </div>

    <!-- Chat Sidebar -->
    <div class="chatbot-sidebar">
      <section class="sidebar-section">
        <h2>Quick Suggestions</h2>
        <button class="suggestion-btn" data-msg="What career paths suit me?">What career paths suit me?</button>
        <button class="suggestion-btn" data-msg="Which skills are in demand?">Which skills are in demand?</button>
        <button class="suggestion-btn" data-msg="How to improve my salary?">How to improve my salary?</button>
        <button class="suggestion-btn" data-msg="Tell me about the job market in Bangalore.">Job market in Bangalore</button>
        <button class="suggestion-btn" data-msg="Guide me in creating a learning plan.">Create learning plan</button>
      </section>

      <section class="sidebar-section">
        <h2>Tips for Chatting</h2>
        <ul>
          <li>Be specific for better answers.</li>
          <li>Ask about courses, certifications, and skills.</li>
          <li>Explore market trends and job opportunities.</li>
          <li>Request personalized career recommendations.</li>
        </ul>
      </section>

      <section class="sidebar-section">
        <h2>Actions</h2>
        <a href="{{ url_for('assessment') }}" class="btn btn-primary btn-full">Take Assessment</a>
        <a href="{{ url_for('dashboard') }}" class="btn btn-secondary btn-full">View Dashboard</a>
        <a href="{{ url_for('profile') }}" class="btn btn-secondary btn-full">Update Profile</a>
      </section>
    </div>
  </div>
</div>

<style>
.container {
  max-width: 1200px;
  margin: auto;
  padding: 2rem;
}

.chatbot-section {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: 2rem;
}

.chatbot-main {
  display: flex;
  flex-direction: column;
  height: 80vh;
  border: 1px solid var(--border-color);
  border-radius: 1rem;
  overflow: hidden;
  background: var(--bg-white);
}

.chat-header {
  background: var(--primary-color);
  color: white;
  padding: 1rem 2rem;
  font-size: 1.5rem;
}

.chat-window {
  flex: 1;
  overflow-y: auto;
  padding: 1rem 2rem;
}

.chat-messages {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.message {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
}

.message.bot .avatar {
  background: var(--primary-color);
  color: white;
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 1.5rem;
}

.message.bot .message-content {
  background: var(--primary-color);
  color: white;
  padding: 0.75rem 1rem;
  border-radius: 1rem;
  max-width: 60%;
}

.message.user {
  flex-direction: row-reverse;
}

.message.user .message-content {
  background: var(--bg-gray);
  color: var(--text-primary);
  padding: 0.75rem 1rem;
  border-radius: 1rem;
  max-width: 60%;
}

.message.user .avatar {
  background: var(--bg-gray);
  color: var(--text-primary);
}

.chat-input-area {
  padding: 1rem 2rem;
  border-top: 1px solid var(--border-color);
  background: var(--bg-gray-light);
  display: flex;
  gap: 1rem;
  align-items: center;
}

#chat-input {
  flex: 1;
  padding: 0.75rem 1rem;
  font-size: 1rem;
  border-radius: 1rem;
  border: 1px solid var(--border-color);
  resize: none;
}

#chat-send {
  padding: 0.75rem 1.5rem;
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: 1rem;
  cursor: pointer;
  font-weight: 600;
  transition: background 0.3s ease;
}

#chat-send:disabled {
  background: var(--border-color);
  cursor: not-allowed;
}

#chat-send:hover:not(:disabled) {
  background: var(--primary-dark);
}

.chatbot-sidebar {
  display: flex;
  flex-direction: column;
  gap: 2rem;
}

.sidebar-section {
  background: var(--bg-white);
  border: 1px solid var(--border-color);
  border-radius: 1rem;
  padding: 1.5rem 2rem;
  box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.sidebar-section h2 {
  margin-bottom: 1rem;
  color: var(--primary-dark);
}

.suggestion-btn {
  display: block;
  width: 100%;
  background: var(--primary-light);
  color: var(--primary-dark);
  border: none;
  padding: 0.75rem 1rem;
  margin-bottom: 0.75rem;
  border-radius: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s ease;
}

.suggestion-btn:hover {
  background: var(--primary-color);
  color: white;
}

.chatbot-sidebar ul {
  list-style: disc;
  padding-left: 1.5rem;
  color: var(--text-secondary);
}

.btn-full {
  display: block;
  width: 100%;
  margin-top: 0.75rem;
}

@media (max-width: 900px) {
  .chatbot-section {
    grid-template-columns: 1fr;
  }
  
  .chatbot-sidebar {
    flex-direction: row;
    overflow-x: auto;
    gap: 1rem;
  }
  
  .sidebar-section {
    min-width: 200px;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const chatInput = document.getElementById('chat-input');
    const chatSend = document.getElementById('chat-send');
    const chatForm = document.getElementById('chat-form');
    const suggestionBtns = document.querySelectorAll('.suggestion-btn');

    // Enable/disable send button based on input
    chatInput.addEventListener('input', function() {
        chatSend.disabled = !this.value.trim();
    });

    // Handle suggestion button clicks
    suggestionBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const message = this.dataset.msg;
            chatInput.value = message;
            chatSend.disabled = false;
            chatInput.focus();
        });
    });

    // Handle form submission
    chatForm.addEventListener('submit', function(e) {
        e.preventDefault();
        if (window.app && window.app.sendChatMessage) {
            window.app.sendChatMessage();
        }
    });
});
</script>
{% endblock %}
